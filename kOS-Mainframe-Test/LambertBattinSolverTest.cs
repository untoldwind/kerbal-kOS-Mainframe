using System;
using NUnit.Framework;
using kOSMainframe.Orbital;
using UnityEngine;

namespace kOSMainframeTest {
    [TestFixture]
    public class LambertSolverTests {
        struct TestSet {
            public Vector3d R1;
            public Vector3d R2;
            public double dt;
            public double mu;
            public Vector3d V1;
            public Vector3d V2;
            public bool shortway;

            public override string ToString() {
                return $"new TestSet {{ R1=new Vector3d({R1.x},{R1.y},{R1.z}), R2=new Vector3d({R2.x},{R2.y},{R2.z}), dt={dt}, mu={mu}, shortway={shortway.ToString().ToLower()}, V1=new Vector3d({V1.x},{V1.y},{V1.z}), V2=new Vector3d({V2.x},{V2.y},{V2.z}) }},";
            }
        }

        TestSet[] testSets = new TestSet[] {
            new TestSet { R1=new Vector3d(648504.023102542,0.66820020588641,-263336.566579579), R2=new Vector3d(-46751083.6470467,4495973.54963698,-1767031.31488983), dt=58553.7382595054, mu=3531600000000, shortway=true, V1=new Vector3d(-1128.28693893474,732.710004902985,-2923.62674986443), V2=new Vector3d(-642.892754257143,51.6621752932847,22.6110542601633) },
            new TestSet { R1=new Vector3d(-698508.997698663,-1.04624163549914,-44642.9983526899), R2=new Vector3d(-45533962.0284302,4857720.23287257,10585880.0358127), dt=13958.0691140458, mu=3531600000000, shortway=false, V1=new Vector3d(-4384.04544952413,406.612437415339,849.487510256224), V2=new Vector3d(-3140.25596595924,341.251041704187,747.386412789405) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-46298009.1016623,4774694.51638226,6534267.02068541), dt=27970.8407848234, mu=3531600000000, shortway=true, V1=new Vector3d(-1677.8707687721,889.301313156503,2972.19428153253), V2=new Vector3d(-1564.48553965589,148.310334040635,171.025545681162) },
            new TestSet { R1=new Vector3d(88835.1538585199,-0.563137876141154,-694287.55866406), R2=new Vector3d(-45662187.7827237,4848336.97147021,10022885.5878112), dt=15555.5524077111, mu=3531600000000, shortway=true, V1=new Vector3d(-4253.38274455443,472.989032332616,-595.397507566659), V2=new Vector3d(-2856.11839790847,302.337873755569,692.750663392863) },
            new TestSet { R1=new Vector3d(-680245.366575571,-1.13961686145816,-164860.064614017), R2=new Vector3d(-44946594.4335642,4888132.95277383,12841721.2654964), dt=5398.41709545829, mu=3531600000000, shortway=false, V1=new Vector3d(-8722.44939318465,932.296340379795,2412.91784746076), V2=new Vector3d(-8167.56058093842,902.366969882006,2402.0706688972) },
            new TestSet { R1=new Vector3d(-546657.182972905,-1.21882838358102,-437136.649210996), R2=new Vector3d(-45643086.5179195,4849814.63101427,10108805.6249249), dt=15553.3592219488, mu=3531600000000, shortway=true, V1=new Vector3d(-4266.20686718916,389.712032365835,333.717388241242), V2=new Vector3d(-2824.96824517265,304.835134312933,670.515550195087) },
            new TestSet { R1=new Vector3d(699899.137770345,0.998060724724007,-5803.2928479754), R2=new Vector3d(-46183856.9336616,4792780.85611444,7285644.13050351), dt=25277.2104137831, mu=3531600000000, shortway=false, V1=new Vector3d(-1452.93234393034,1882.37042679754,2723.058727917), V2=new Vector3d(-1746.87399216329,152.75712786447,234.490324171116) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-46765086.4144957,4601931.7857603,921366.639269856), dt=48539.8644268824, mu=3531600000000, shortway=false, V1=new Vector3d(-1099.6906652775,1130.43987837796,2851.51455435321), V2=new Vector3d(-822.275725256611,64.5130298608974,-29.2090138651736) },
            new TestSet { R1=new Vector3d(527942.324205418,0.300123116961838,-459553.914378887), R2=new Vector3d(-44838580.0473146,3850725.29876581,-13552625.3550374), dt=102395.877937986, mu=3531600000000, shortway=false, V1=new Vector3d(449.088248408965,-257.189907066872,3121.07863240072), V2=new Vector3d(-234.378787852199,23.1566186721727,-112.193063814592) },
            new TestSet { R1=new Vector3d(-681079.206618947,-1.13735169746337,-161380.229659558), R2=new Vector3d(-46489666.0808927,4329818.5067105,-5381785.89187956), dt=72578.4931760923, mu=3531600000000, shortway=true, V1=new Vector3d(-3138.61464492514,170.848273273946,-521.382046808871), V2=new Vector3d(-454.508168032654,44.8336765829741,-49.3584479837841) },
            new TestSet { R1=new Vector3d(694285.442508468,0.907581291611329,-88677.3996024172), R2=new Vector3d(-45365805.5226489,3977221.91676954,-11624344.9323376), dt=96862.261225875, mu=3531600000000, shortway=true, V1=new Vector3d(-73.105950546529,706.728153201957,-3085.81015285284), V2=new Vector3d(-291.535113762875,14.74301406823,-27.3331156566455) },
            new TestSet { R1=new Vector3d(83462.7728388584,0.810878495964743,694912.641854852), R2=new Vector3d(-40688359.6173382,3065307.84858101,-23325121.2096226), dt=142600.153251071, mu=3531600000000, shortway=true, V1=new Vector3d(-2681.05484668145,232.922630236071,1646.84765024764), V2=new Vector3d(-70.7000593856451,4.84843592121011,-89.6973204823052) },
            new TestSet { R1=new Vector3d(481129.750292077,0.184439018059692,-508359.651655802), R2=new Vector3d(-43846037.1134977,3637922.64326495,-16531501.6947463), dt=115866.7475902, mu=3531600000000, shortway=false, V1=new Vector3d(561.189080706555,-213.819852592515,3101.59302910708), V2=new Vector3d(-168.895246777439,16.3595865351566,-104.220288179979) },
            new TestSet { R1=new Vector3d(602485.984566073,1.21841502437299,356215.011901523), R2=new Vector3d(-44260358.9834996,3723668.04151633,-15367332.8514851), dt=110928.183016368, mu=3531600000000, shortway=false, V1=new Vector3d(997.740173891856,-1157.31026287883,-2767.03100151627), V2=new Vector3d(-219.015389741972,34.1796829254592,-30.3471322741073) },
            new TestSet { R1=new Vector3d(-279847.666324668,0.236703909585675,641529.94386912), R2=new Vector3d(-46206212.1895491,4219920.37084003,-7495213.61657745), dt=80802.2306905967, mu=3531600000000, shortway=false, V1=new Vector3d(-2879.85570210115,198.15696406304,1275.97263728428), V2=new Vector3d(-378.192475038362,35.7396794401646,-93.6036278614258) },
            new TestSet { R1=new Vector3d(-547732.455421296,-0.352185687133946,435747.250595384), R2=new Vector3d(-46595577.679593,4703817.09748889,3965633.04131675), dt=38674.2803093275, mu=3531600000000, shortway=true, V1=new Vector3d(-3190.41680164115,229.841746279385,920.600605553881), V2=new Vector3d(-1058.70552944543,109.577997152177,71.0896886383739) },
            new TestSet { R1=new Vector3d(580887.120655098,0.444755013513453,-390486.466255952), R2=new Vector3d(-46774410.2088576,4537809.68093652,-750221.909246584), dt=54904.3857767091, mu=3531600000000, shortway=false, V1=new Vector3d(-1514.96684054554,537.992851840892,-2798.32675983682), V2=new Vector3d(-698.547263560382,61.0881191230273,36.1954443232176) },
            new TestSet { R1=new Vector3d(698089.728179379,0.950863639010147,-50646.6313989141), R2=new Vector3d(-46776765.5700639,4572991.20788394,148169.551184094), dt=51462.5673468455, mu=3531600000000, shortway=false, V1=new Vector3d(-708.658143653159,2606.1481082112,-1798.17208457294), V2=new Vector3d(-764.878003726566,35.8822263018108,30.0257664875896) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-46076180.0454369,4807312.46161082,7929399.68200139), dt=22815.7968064565, mu=3531600000000, shortway=false, V1=new Vector3d(-2018.04790925715,862.923028720951,3003.49276742203), V2=new Vector3d(-1946.87195132743,190.416261463178,283.298779302233) },
            new TestSet { R1=new Vector3d(542658.414095653,0.338610522010317,-442079.04015081), R2=new Vector3d(-46343242.7513321,4766557.24770933,6211584.60422247), dt=29450.0355324545, mu=3531600000000, shortway=true, V1=new Vector3d(-2538.01780725903,659.930251071979,-2299.38864626565), V2=new Vector3d(-1463.48062368405,142.796365078556,247.292163917794) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-44836063.6906304,4892096.46640608,13220997.8781144), dt=2975.16476206355, mu=3531600000000, shortway=true, V1=new Vector3d(-15247.2409828429,1844.79789612993,5405.19225875146), V2=new Vector3d(-15277.9943279929,1639.07240549372,4364.9611556668) },
            new TestSet { R1=new Vector3d(87928.725414477,-0.564552690592015,-694402.946125679), R2=new Vector3d(-46379754.8755538,4759497.1581142,5938478.29712665), dt=30692.7497313019, mu=3531600000000, shortway=false, V1=new Vector3d(-3085.71270002858,341.463003566747,-1483.12110660189), V2=new Vector3d(-1385.19618391948,141.50171025639,226.372356688296) },
            new TestSet { R1=new Vector3d(-327988.054571886,-1.08543520609725,-618345.933701928), R2=new Vector3d(-46659377.7262322,4418901.79809053,-3517922.27026385), dt=65477.6677194777, mu=3531600000000, shortway=false, V1=new Vector3d(-2790.91956892641,197.193189474078,-1493.12340605281), V2=new Vector3d(-535.048852249081,52.0583105388678,-13.8500164157796) },
            new TestSet { R1=new Vector3d(-206324.834964219,-0.961170372891983,-668848.869202104), R2=new Vector3d(-44613275.9122684,4898782.02084446,13951972.8744025), dt=847.115957985858, mu=3531600000000, shortway=true, V1=new Vector3d(-52529.2957857588,5791.84081962949,17199.1266389241), V2=new Vector3d(-52415.90582371,5782.34041036602,17259.1688807028) },
            new TestSet { R1=new Vector3d(-691440.787585482,-0.883607721487743,108678.686285988), R2=new Vector3d(-43587022.5706722,3586092.20052192,-17213698.2125592), dt=117351.92344256, mu=3531600000000, shortway=true, V1=new Vector3d(-3129.22859513248,133.771668257658,-405.848573715763), V2=new Vector3d(-164.704229659005,15.673071151688,-79.2866640141985) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-46446388.8921853,4310977.22766213,-5757467.69148252), dt=72976.2018686603, mu=3531600000000, shortway=true, V1=new Vector3d(-845.216992414229,1897.3589558423,2418.49561832627), V2=new Vector3d(-461.433182660673,15.1079567796738,-95.6540742447355) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-45918510.6191232,4128031.08939953,-9135083.02350986), dt=85468.1633463745, mu=3531600000000, shortway=false, V1=new Vector3d(-119.773946190832,-2708.63877175345,-1650.59295634964), V2=new Vector3d(-356.294944026986,72.0588420062696,-46.9365966991489) },
            new TestSet { R1=new Vector3d(191578.743320981,-0.394821485706054,-673218.096269527), R2=new Vector3d(-43020700.2388827,3476683.78912528,-18604623.6400157), dt=122220.8874567, mu=3531600000000, shortway=true, V1=new Vector3d(-1468.07099741335,162.786342608188,-2790.74400120836), V2=new Vector3d(-166.453252621406,12.7268849338821,-36.5828756665862) },
            new TestSet { R1=new Vector3d(-340156.040899168,-1.09631335146108,-611736.521880694), R2=new Vector3d(-39622254.4707394,2891617.09523301,-25114049.8771212), dt=149366.272563073, mu=3531600000000, shortway=true, V1=new Vector3d(-2186.61922939769,104.13985164107,-2270.5782702884), V2=new Vector3d(-75.7858737818355,6.42492277279762,-33.7690599617477) },
            new TestSet { R1=new Vector3d(699557.384053326,1.02582136475566,22600.4141302019), R2=new Vector3d(-32004454.4920808,1787599.46750451,-34373236.4028776), dt=194713.341357712, mu=3531600000000, shortway=true, V1=new Vector3d(1291.67790701484,156.252229331312,-2872.3101611872), V2=new Vector3d(-30.9837568361773,-1.68475074506963,30.4184606562493) },
            new TestSet { R1=new Vector3d(-565593.777835798,-1.22132641522448,-412341.323184634), R2=new Vector3d(-34047612.0235249,2066425.08027266,-32334037.8375968), dt=182966.791221662, mu=3531600000000, shortway=false, V1=new Vector3d(2420.10860423655,-70.2335944323129,2019.68425934879), V2=new Vector3d(-11.3460434355631,-0.478180114956824,-6.53359570238442) },
            new TestSet { R1=new Vector3d(103630.136564442,-0.539875295512093,-692233.676877407), R2=new Vector3d(-31703851.5591545,1747374.9389154,-34652741.2644072), dt=194713.341357712, mu=3531600000000, shortway=true, V1=new Vector3d(-934.856084826129,65.6249045496922,-3010.472966329), V2=new Vector3d(-11.1975057988187,0.402664889866405,18.0132788363557) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-31599332.9077802,1733433.70930705,-34748775.0483195), dt=194713.341357712, mu=3531600000000, shortway=false, V1=new Vector3d(-1609.99335588333,-201.487012785632,2703.80026497032), V2=new Vector3d(33.5540982600653,2.48613363839614,-29.9022749012834) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-31599332.9077802,1733433.70930705,-34748775.0483195), dt=194713.341357712, mu=3531600000000, shortway=true, V1=new Vector3d(1610.89694381357,201.467038399547,-2703.26350559445), V2=new Vector3d(-32.8134747476248,-2.52633279193133,30.7100920076304) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-33925746.7286883,2049510.97102411,-32462951.4012596), dt=182757.102439975, mu=3531600000000, shortway=true, V1=new Vector3d(1499.88771674541,269.375423274175,-2760.68714297145), V2=new Vector3d(-45.241340378614,-2.65489936977001,19.5105094101746) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-37506134.8151922,2564618.16825851,-28208377.9199667), dt=162372.690707146, mu=3531600000000, shortway=true, V1=new Vector3d(1297.8634141581,433.999553306006,-2841.47717883731), V2=new Vector3d(-74.8582442228149,-2.73343930574592,1.04312697085237) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-31599332.9077802,1733433.70930705,-34748775.0483195), dt=194713.341357712, mu=3531600000000, shortway=false, V1=new Vector3d(-1609.99335588333,-201.487012785632,2703.80026497032), V2=new Vector3d(33.5540982600653,2.48613363839614,-29.9022749012834) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-31599332.9077802,1733433.70930705,-34748775.0483195), dt=194713.341357712, mu=3531600000000, shortway=false, V1=new Vector3d(-1609.99335588333,-201.487012785632,2703.80026497032), V2=new Vector3d(33.5540982600653,2.48613363839614,-29.9022749012834) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-31599332.9077802,1733433.70930705,-34748775.0483195), dt=194713.341357712, mu=3531600000000, shortway=false, V1=new Vector3d(-1609.99335588333,-201.487012785632,2703.80026497032), V2=new Vector3d(33.5540982600653,2.48613363839614,-29.9022749012834) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-33238084.0081766,1954767.29490029,-33172408.0568201), dt=186378.116149814, mu=3531600000000, shortway=true, V1=new Vector3d(1534.03788284956,247.120436403613,-2743.91450057128), V2=new Vector3d(-41.1274514960118,-2.62637156232968,22.8880300795601) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-32943442.5020117,1914523.86510648,-33467360.1362071), dt=187906.091665152, mu=3531600000000, shortway=true, V1=new Vector3d(1548.30719509336,238.199589199097,-2736.66737829687), V2=new Vector3d(-39.4850874065897,-2.61179308670187,24.3179965794033) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-34132408.2792195,2078216.91107833,-32243754.7368661), dt=181653.113478222, mu=3531600000000, shortway=true, V1=new Vector3d(1489.38023100973,276.493240486304,-2765.68252539997), V2=new Vector3d(-46.559166570623,-2.66204675740281,18.4845299640763) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-31601658.2754193,1733743.63047714,-34746644.8346801), dt=194701.781409304, mu=3531600000000, shortway=true, V1=new Vector3d(1610.79198176488,201.525573864263,-2703.32169125335), V2=new Vector3d(-32.823938216262,-2.52650797639712,30.699219183514) },
            new TestSet { R1=new Vector3d(613252.581675944,0.543991409328018,-337384.482110632), R2=new Vector3d(-31646346.118767,1739701.74359297,-34705651.055333), dt=194713.341357712, mu=3531600000000, shortway=true, V1=new Vector3d(496.28339149359,94.7838577082831,-3112.40483303188), V2=new Vector3d(-25.4835872112206,-0.435827071813679,27.0750846069848) },
            new TestSet { R1=new Vector3d(177458.808521977,-0.41891149391334,-677077.314100262), R2=new Vector3d(-37475972.5213705,2560098.71072216,-28248847.3777045), dt=163044.281747769, mu=3531600000000, shortway=true, V1=new Vector3d(-1081.00290417736,105.924544646124,-2960.48363946871), V2=new Vector3d(-57.9799741497722,3.45922087420195,-10.1553334819858) },
            new TestSet { R1=new Vector3d(323201.004068766,-0.1539619879943,-620856.406259257), R2=new Vector3d(-35097054.4827933,2213723.98940212,-31181664.3675507), dt=176812.492351303, mu=3531600000000, shortway=true, V1=new Vector3d(-607.99445765809,95.6511705734054,-3092.49519847769), V2=new Vector3d(-38.6531909333999,1.55719720871049,4.89226185339933) },
            new TestSet { R1=new Vector3d(193949.826921713,0.947050486954952,672497.523439793), R2=new Vector3d(-41419051.3912164,3188829.87852858,-21983938.3609391), dt=137060.214389554, mu=3531600000000, shortway=true, V1=new Vector3d(-2515.17908173573,278.077098830853,1885.4175411414), V2=new Vector3d(-87.4283850029159,5.42887515733335,-96.0704845355001) },
            new TestSet { R1=new Vector3d(319460.563221635,-0.161249311814688,-622789.395611979), R2=new Vector3d(-40859682.7314299,3093911.62184101,-23019861.8145965), dt=142112.856802874, mu=3531600000000, shortway=false, V1=new Vector3d(855.731677316669,-141.668932803489,3033.25436716914), V2=new Vector3d(-76.0496916983925,6.86614543498514,-79.6041216954953) },
            new TestSet { R1=new Vector3d(49288.4840070939,-0.623759784904652,-698210.637499725), R2=new Vector3d(-44325923.9950605,3737600.84684645,-15173753.7179754), dt=110814.738726446, mu=3531600000000, shortway=true, V1=new Vector3d(-1866.31629217839,168.44443414764,-2544.7158865753), V2=new Vector3d(-210.791864941947,17.5868786477348,-39.9314127814466) },
            new TestSet { R1=new Vector3d(440736.915503962,1.172914024539,543712.532047385), R2=new Vector3d(-41570932.0489089,3215036.53797666,-21691499.4558807), dt=135979.031500467, mu=3531600000000, shortway=false, V1=new Vector3d(1865.69380838329,-520.755985031455,-2491.48544018104), V2=new Vector3d(-132.63896795676,15.7792397447374,-18.3937994907929) },
            new TestSet { R1=new Vector3d(271356.824106678,-0.25253647908405,-645204.273328265), R2=new Vector3d(-33948973.0491124,2052731.68809825,-32438457.4467917), dt=185033.769707684, mu=3531600000000, shortway=false, V1=new Vector3d(655.913406690193,-84.2150331216744,3082.9099016802), V2=new Vector3d(10.2503256180238,0.0533444730658398,-27.3134041533254) },
            new TestSet { R1=new Vector3d(348767.803711931,-0.103373867191638,-606862.222119054), R2=new Vector3d(-39330089.5711068,2845181.4489106,-25574381.6514005), dt=152999.634053028, mu=3531600000000, shortway=true, V1=new Vector3d(-809.361286265502,134.790750907761,-3045.4137335403), V2=new Vector3d(-82.1114764777371,4.74475042300011,-13.8987018702852) },
            new TestSet { R1=new Vector3d(699878.479168238,1.01163674161213,7875.99332263238), R2=new Vector3d(-32005759.0802289,1787774.45858832,-34372012.5710375), dt=194713.341357712, mu=3531600000000, shortway=true, V1=new Vector3d(1261.05820988019,152.453785204212,-2886.0838344256), V2=new Vector3d(-30.8081632468259,-1.61282849443616,30.3352116719388) },
            new TestSet { R1=new Vector3d(612554.248883899,1.21534476468015,338609.533579153), R2=new Vector3d(-44327685.6157475,3737976.69690682,-15168514.0394447), dt=110169.671507437, mu=3531600000000, shortway=false, V1=new Vector3d(917.93729611261,-1297.39684007874,-2732.57538941096), V2=new Vector3d(-221.927604332866,36.6427268494398,-31.1687600649677) },
            new TestSet { R1=new Vector3d(-294229.82624614,0.209643794163777,635062.67622198), R2=new Vector3d(-43732830.1794531,3615115.76647635,-16833612.2828727), dt=116168.722520973, mu=3531600000000, shortway=false, V1=new Vector3d(2879.9834378248,-160.172502147285,-1288.1273117821), V2=new Vector3d(-190.085841775362,14.6355814900176,-40.0126595822428) },
            new TestSet { R1=new Vector3d(-294183.556178717,0.209731475988545,635084.110427964), R2=new Vector3d(-46592611.7140112,4704830.97383284,3999137.30385001), dt=38696.4029575182, mu=3531600000000, shortway=true, V1=new Vector3d(-3001.04122480543,246.341124131517,1421.54556346895), V2=new Vector3d(-1063.5074830178,108.946282227746,59.3526329400138) },
            new TestSet { R1=new Vector3d(269993.170926387,-0.255061077665753,-645776.126036154), R2=new Vector3d(-45881185.854562,4116973.72373671,-9325626.62437226), dt=86620.8388536821, mu=3531600000000, shortway=false, V1=new Vector3d(1250.16021226954,-203.968906909124,2908.76773444153), V2=new Vector3d(-336.205350127833,31.3683802746014,-103.048701101796) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-45290791.6159158,3958413.65961309,-11919528.3506975), dt=95900.9167241395, mu=3531600000000, shortway=false, V1=new Vector3d(-502.375999330963,-3117.33484610727,246.020817682584), V2=new Vector3d(-279.588991723805,71.1425201160643,-79.1699137256663) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-46548802.4331654,4718706.33973607,4465736.50336286), dt=35575.6126583686, mu=3531600000000, shortway=true, V1=new Vector3d(-1371.58942626189,953.273161949317,2932.02217977005), V2=new Vector3d(-1195.64386858963,107.307058476783,66.9102365916964) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-44910859.0799703,4889464.87777937,12965641.9011173), dt=3945.90887856159, mu=3531600000000, shortway=false, V1=new Vector3d(-11490.0644457961,1490.95414349325,4510.79077935384), V2=new Vector3d(-11524.8098191149,1232.18311969684,3215.15013428621) },
            new TestSet { R1=new Vector3d(-699848.880593976,-0.992998342197141,10820.6034996698), R2=new Vector3d(-46637312.3106005,4405183.37362682,-3815161.84299273), dt=66908.4787427219, mu=3531600000000, shortway=true, V1=new Vector3d(-3187.72522992263,177.036166883711,-133.018388699249), V2=new Vector3d(-514.790332525645,51.2818475996581,-44.8480886092237) },
            new TestSet { R1=new Vector3d(-338747.048676253,-1.09506965654869,-612517.885281252), R2=new Vector3d(-44744357.8557792,3829315.85530243,-13866462.4239311), dt=104017.520333371, mu=3531600000000, shortway=true, V1=new Vector3d(-2515.46879651433,150.682119531473,-1910.40818930269), V2=new Vector3d(-236.433700878223,21.3753251410311,-53.3000058873816) },
            new TestSet { R1=new Vector3d(-314028.842047545,-1.07258031753986,-625550.8806837), R2=new Vector3d(-34654895.4958791,2151294.91210586,-31676649.8918501), dt=179539.017303235, mu=3531600000000, shortway=true, V1=new Vector3d(-1911.17698845554,74.8919792309364,-2506.58217265499), V2=new Vector3d(-19.3820757083981,1.88189435667591,-5.93162588880941) },
            new TestSet { R1=new Vector3d(267330.156469907,-0.259981554461266,-646883.124366477), R2=new Vector3d(-32801201.5846339,1895168.81752288,-33607878.685768), dt=189083.398743416, mu=3531600000000, shortway=true, V1=new Vector3d(-620.118771143515,77.0110047009235,-3090.47192143113), V2=new Vector3d(-21.4510898602067,0.611753012645266,15.4383089738867) },
            new TestSet { R1=new Vector3d(697695.608216547,1.05614664918145,55774.5431044939), R2=new Vector3d(-41112325.6141503,3136482.55383567,-22559679.9575164), dt=137866.963335642, mu=3531600000000, shortway=false, V1=new Vector3d(-1012.74171625254,-492.901938145298,2947.76377182645), V2=new Vector3d(-83.9722490968525,14.7710433099712,-97.4771932563337) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-37061340.7012092,2498323.90373401,-28796100.484283), dt=165072.424916932, mu=3531600000000, shortway=true, V1=new Vector3d(1325.68050199207,407.291206509614,-2832.45903725859), V2=new Vector3d(-70.2478175056861,-2.72191644974271,3.41436471802794) },
            new TestSet { R1=new Vector3d(428892.031989226,0.0649726622230834,-553144.97053404), R2=new Vector3d(-31671898.7114104,1743110.47919562,-34682162.5316455), dt=194713.341357712, mu=3531600000000, shortway=false, V1=new Vector3d(151.572281027288,-77.1736419125009,3148.470610375), V2=new Vector3d(24.9390257638471,-0.327492434239146,-17.973537454418) },
            new TestSet { R1=new Vector3d(690047.790645728,0.873153968731106,-117180.294982349), R2=new Vector3d(-31625383.3770699,1736906.31713204,-34724894.2791603), dt=194713.341357712, mu=3531600000000, shortway=false, V1=new Vector3d(-1008.84829754926,-121.890518115755,2984.98624397414), V2=new Vector3d(31.4171099050104,0.934085915553509,-26.896439215073) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-36428735.771351,2405280.53642086,-29600031.0074534), dt=168819.815773528, mu=3531600000000, shortway=true, V1=new Vector3d(1363.71175640569,373.130737985548,-2818.94053939974), V2=new Vector3d(-64.2172281079804,-2.71045485241053,6.7507372223532) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-33452927.1413037,1984242.37899474,-32953974.6898614), dt=185255.246177332, mu=3531600000000, shortway=true, V1=new Vector3d(1523.49876240405,253.849445085138,-2749.17739149682), V2=new Vector3d(-42.369452285332,-2.63609520641507,21.8388348150202) },
            new TestSet { R1=new Vector3d(679135.577372613,1.14243481934594,169293.608600475), R2=new Vector3d(-31599535.8823849,1733460.76097947,-34748589.1196752), dt=194713.341357712, mu=3531600000000, shortway=false, V1=new Vector3d(-1605.56415901349,-200.422441366855,2706.51127377064), V2=new Vector3d(33.5417608842122,2.46740490515349,-29.8855965193857) },
            new TestSet { R1=new Vector3d(623341.704630269,0.57738670646404,-318357.114821579), R2=new Vector3d(-33901726.343081,2046181.59539529,-32488245.4410439), dt=183109.19782213, mu=3531600000000, shortway=false, V1=new Vector3d(-452.159482246454,-118.634636881039,3118.36670093585), V2=new Vector3d(14.2101629612316,1.32362232347096,-39.4728147833041) },
            new TestSet { R1=new Vector3d(466915.62345488,0.151036531371603,-521445.924653237), R2=new Vector3d(-36239821.3409093,2377762.66077457,-29833229.6928777), dt=170258.294348626, mu=3531600000000, shortway=false, V1=new Vector3d(231.449327112168,-115.03128639269,3142.73867643852), V2=new Vector3d(-9.27360429312964,2.09052823595584,-51.4556527822672) },
            new TestSet { R1=new Vector3d(690440.406832083,1.10445116021726,114802.617443342), R2=new Vector3d(-33467611.4804225,1986261.07009516,-32938939.7029855), dt=185204.015097204, mu=3531600000000, shortway=true, V1=new Vector3d(1407.0678614332,221.116739347062,-2813.30039315148), V2=new Vector3d(-41.9398372123819,-2.07253844613112,21.5879634174751) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-34541836.639253,2135419.4741298,-31800967.0490799), dt=179443.184599486, mu=3531600000000, shortway=false, V1=new Vector3d(-1511.18691320069,-290.116377058392,2752.46053619463), V2=new Vector3d(12.2095602277755,4.94455454886927,-50.3347725769664) },
            new TestSet { R1=new Vector3d(697845.973163594,0.947275646284529,-53902.5451829829), R2=new Vector3d(-44651359.9297279,3808477.91765637,-14168682.0973798), dt=104550.690251625, mu=3531600000000, shortway=false, V1=new Vector3d(-613.520983178935,-645.863384735046,3035.03281848471), V2=new Vector3d(-222.061772028538,29.0345005895524,-117.157411339061) },
            new TestSet { R1=new Vector3d(699919.947903195,1.00177758263944,-2096.32624939512), R2=new Vector3d(-44785662.6289001,3838663.21947535,-13729861.1638204), dt=102849.832591609, mu=3531600000000, shortway=true, V1=new Vector3d(221.181218474699,841.998639662606,-3041.63475758561), V2=new Vector3d(-259.245396090118,9.06147906573009,-31.9514335303782) },
            new TestSet { R1=new Vector3d(678583.741802714,1.14382982389337,171491.919388464), R2=new Vector3d(-46705771.8991244,4654821.9740513,2429712.67783773), dt=43029.443088621, mu=3531600000000, shortway=true, V1=new Vector3d(-1190.94628046861,1043.62417538838,2890.10187286982), V2=new Vector3d(-955.295640940439,80.0445689887928,3.33320951430154) },
            new TestSet { R1=new Vector3d(-113709.867106506,-0.85002179612362,-690651.000013471), R2=new Vector3d(-46725283.271075,4468676.52208258,-2403920.41856197), dt=61301.3374187868, mu=3531600000000, shortway=false, V1=new Vector3d(-2613.35543386742,223.312709849518,-1810.688766827), V2=new Vector3d(-591.260672450369,57.0900287517424,3.80264707047593) },
            new TestSet { R1=new Vector3d(-337417.89382933,-1.09389257372091,-613251.094503688), R2=new Vector3d(-46583976.9398404,4375334.30557995,-4448543.82723505), dt=68892.2995630101, mu=3531600000000, shortway=false, V1=new Vector3d(-2769.20597245459,191.615360590169,-1519.87976111603), V2=new Vector3d(-495.988408247935,47.9729882502893,-21.9183134056106) },
            new TestSet { R1=new Vector3d(-612778.739208397,-0.542479865258461,338220.918754108), R2=new Vector3d(-46316259.1972045,4259371.18705079,-6757358.29065526), dt=77872.7496292008, mu=3531600000000, shortway=true, V1=new Vector3d(-3146.67251495319,172.984820285471,424.122528389389), V2=new Vector3d(-403.559550921219,39.4011321762002,-76.2447947914843) },
            new TestSet { R1=new Vector3d(-406807.037954479,-1.14998978734236,-569591.654845261), R2=new Vector3d(-46599235.552917,4383481.58027434,-4277421.55032075), dt=68301.3709736137, mu=3531600000000, shortway=true, V1=new Vector3d(-2871.05674474214,189.429894017009,-1385.15586237104), V2=new Vector3d(-503.786948388165,49.0438415415187,-23.2422340847217) },
            new TestSet { R1=new Vector3d(-164747.940177467,0.440290916498826,680243.172221919), R2=new Vector3d(-46119665.0537997,4190827.78611468,-8025799.51110522), dt=82820.4349694881, mu=3531600000000, shortway=true, V1=new Vector3d(-2791.27719927384,211.71786877445,1499.47835728147), V2=new Vector3d(-363.608369395517,33.7968393680587,-99.0891662781869) },
            new TestSet { R1=new Vector3d(64041.1063754228,0.785070096296786,696970.91526532), R2=new Vector3d(-41327496.5045973,3173125.49522691,-22157827.2232192), dt=137720.477890274, mu=3531600000000, shortway=true, V1=new Vector3d(-2687.32152890202,229.182986884287,1638.06362274841), V2=new Vector3d(-85.497326981417,6.20929231006467,-93.6984738767259) },
            new TestSet { R1=new Vector3d(-625586.988733836,-0.585040114519614,313900.019462085), R2=new Vector3d(-41355365.0328119,3177898.4932341,-22105084.1249151), dt=137129.084164092, mu=3531600000000, shortway=true, V1=new Vector3d(-3150.68999131557,125.570461038332,-112.496131725302), V2=new Vector3d(-92.0698877694882,8.97455135978947,-74.8292362537227) },
            new TestSet { R1=new Vector3d(-651775.405619815,-0.681069225374287,255115.281273738), R2=new Vector3d(-40033158.7657583,2957734.59060653,-24445817.747155), dt=146941.923414317, mu=3531600000000, shortway=true, V1=new Vector3d(-3134.55982046379,115.011759630962,-332.997738926041), V2=new Vector3d(-64.9436222021718,6.67071940353131,-65.0539172803899) },
            new TestSet { R1=new Vector3d(-589877.036941854,-0.471319433365127,376741.873986428), R2=new Vector3d(-44651313.0619156,3808467.48628901,-14168832.6002068), dt=105683.299979936, mu=3531600000000, shortway=false, V1=new Vector3d(3119.88370373573,-133.549091556702,-495.722968862049), V2=new Vector3d(-230.114209995268,17.862934353543,-53.2453430855731) },
            new TestSet { R1=new Vector3d(-598819.788644504,-1.21930990911562,-362401.454352008), R2=new Vector3d(-41010332.6499475,3119239.07909204,-22746933.0571863), dt=139481.595560616, mu=3531600000000, shortway=false, V1=new Vector3d(2727.33353938449,-102.666403544267,1582.35576689938), V2=new Vector3d(-94.8759731624473,5.71706758929238,-53.6201723675913) },
            new TestSet { R1=new Vector3d(-311558.032270273,0.176516747184857,626743.886618509), R2=new Vector3d(-43935343.6897694,3656092.33220237,-16288602.2641676), dt=114033.834577867, mu=3531600000000, shortway=false, V1=new Vector3d(2888.95933399034,-158.656320592116,-1269.37569832823), V2=new Vector3d(-198.365558349621,15.3819817713464,-41.3321969028841) },
            new TestSet { R1=new Vector3d(-625996.045487321,-0.586438908095786,313083.521511727), R2=new Vector3d(-43825840.208069,3633835.59980352,-16585866.5402323), dt=114991.168865703, mu=3531600000000, shortway=false, V1=new Vector3d(3148.45016598382,-127.443962710484,-224.220065195794), V2=new Vector3d(-187.804906120261,13.7514965546497,-51.785433127982) },
            new TestSet { R1=new Vector3d(1324445.49928975,1484278.03675318,206707.674884781), R2=new Vector3d(-10023257.6870721,0,6598053.14759971), dt=7935.5233324863, mu=3531600000000, shortway=false, V1=new Vector3d(-1462.33934188636,681.134788339992,1457.5695556927), V2=new Vector3d(-1232.0398262017,-306.551439481764,588.263440303495) },
            new TestSet { R1=new Vector3d(-1450954.26078497,-817502.118854809,1107396.82118262), R2=new Vector3d(-11371348.0838921,0,3833072.23450894), dt=10033.3385318989, mu=3531600000000, shortway=true, V1=new Vector3d(-1741.11297839642,-137.386564278553,690.807649984908), V2=new Vector3d(-738.179548212257,107.640881200706,167.413998922775) },
            new TestSet { R1=new Vector3d(1288272.95623323,432279.341870256,-1467521.41499764), R2=new Vector3d(-11062969.9341534,0,4648730.60480155), dt=13570.4509806091, mu=3531600000000, shortway=false, V1=new Vector3d(519.275762319652,-838.367115506725,1578.04200270588), V2=new Vector3d(-709.786189042197,117.91750993194,45.6123125607241) },
            new TestSet { R1=new Vector3d(-245137.800752945,838912.816643432,1798876.55931006), R2=new Vector3d(-11675015.7364651,0,-2773807.41099516), dt=24103.9335546317, mu=3531600000000, shortway=true, V1=new Vector3d(-1518.46422285246,473.850565522382,688.208035694), V2=new Vector3d(-21.9705788374183,-99.160501260126,-224.733405584875) },
            new TestSet { R1=new Vector3d(-1459314.79044494,-846018.795203452,1074505.27905074), R2=new Vector3d(-10557707.5673233,0,-5703929.42828745), dt=28148.5163085554, mu=3531600000000, shortway=true, V1=new Vector3d(-1679.42777693572,-392.522610830998,-43.0036583130562), V2=new Vector3d(119.63944538855,80.3217372234552,-112.230323280873) },
            new TestSet { R1=new Vector3d(1150155.91582764,1530617.61495005,578170.681259743), R2=new Vector3d(-10683433.8768746,0,-5464818.44148998), dt=30960.7290321349, mu=3531600000000, shortway=false, V1=new Vector3d(740.914892115432,-1521.70153266934,389.095691438575), V2=new Vector3d(2.9945075851948,269.974189779711,-0.260309855291025) },
            new TestSet { R1=new Vector3d(-588438.463124267,-1395585.29542553,-1306222.71084055), R2=new Vector3d(-9033624.05119275,0,-7898964.26765635), dt=30960.7290321349, mu=3531600000000, shortway=false, V1=new Vector3d(1078.95046619496,520.860826042063,1238.90641178211), V2=new Vector3d(98.2011766903162,-132.756560859762,10.555915019956) },
            new TestSet { R1=new Vector3d(-366975.904304029,730003.0253299,1825444.34952721), R2=new Vector3d(-10753480.4311527,0,-5325660.39255386), dt=28991.2714891106, mu=3531600000000, shortway=false, V1=new Vector3d(1574.39119659249,-480.115644046449,-540.390975006096), V2=new Vector3d(-113.340724284395,90.4934425789918,192.685415118915) },
            new TestSet { R1=new Vector3d(-1272932.12234965,-403625.499921349,1488823.76720609), R2=new Vector3d(-11529031.1050398,0,-3328879.95863838), dt=23888.6799517237, mu=3531600000000, shortway=false, V1=new Vector3d(1669.91429312595,190.534013074168,-394.141590660878), V2=new Vector3d(-134.223372251261,-37.4257924898693,133.374529864577) },
            new TestSet { R1=new Vector3d(-1437250.14881701,-774493.386294427,1155150.56147031), R2=new Vector3d(-10755214.9737684,0,-5322156.5993521), dt=27438.950309544, mu=3531600000000, shortway=false, V1=new Vector3d(1689.16729862777,348.817047868758,-4.70068043237379), V2=new Vector3d(-78.3237752626338,-75.0251435364871,142.036686956219) },
            new TestSet { R1=new Vector3d(-1498999.38608283,-1046268.94377841,811330.839281492), R2=new Vector3d(-11289229.5250945,0,-4068574.28711018), dt=24592.1461355463, mu=3531600000000, shortway=true, V1=new Vector3d(-1667.93109539197,-427.181065458112,-49.2838786625189), V2=new Vector3d(28.4893598355604,97.8596766189627,-116.146930979578) },
            new TestSet { R1=new Vector3d(-1099574.61255371,-118115.79351161,1666382.5467503), R2=new Vector3d(-10759545.9891265,0,-5313395.34646834), dt=28102.4320860372, mu=3531600000000, shortway=false, V1=new Vector3d(1699.88563323744,61.207958508989,-305.454740658955), V2=new Vector3d(-103.003512955197,-12.4057858315763,181.187114042709) },
            new TestSet { R1=new Vector3d(-971326.238985369,62424.0943752913,1747130.68799387), R2=new Vector3d(-10038250.0705312,0,-6575221.32870682), dt=30960.7290321349, mu=3531600000000, shortway=true, V1=new Vector3d(-1701.42117287768,37.533714702738,318.586178027854), V2=new Vector3d(182.886469253312,-6.94864079300464,-145.506936628552) },
            new TestSet { R1=new Vector3d(735549.747920468,1456081.75005057,1157008.98029161), R2=new Vector3d(-10546427.857215,0,-5724758.46237716), dt=30960.7290321349, mu=3531600000000, shortway=true, V1=new Vector3d(-1048.79168829164,1375.90484449268,146.717937229311), V2=new Vector3d(86.0990047986492,-240.761415413108,-78.5558625580461) },
            new TestSet { R1=new Vector3d(-1164401.79460787,-217982.189142765,1611367.38290841), R2=new Vector3d(-9955367.73469268,0,-6700048.75109427), dt=30960.7290321349, mu=3531600000000, shortway=true, V1=new Vector3d(-1714.07884436167,-123.423202432154,202.48887596803), V2=new Vector3d(183.829260650988,23.0955266120167,-130.037117385615) },
            new TestSet { R1=new Vector3d(-1476503.9924747,-912980.029499982,993136.817490643), R2=new Vector3d(-9723806.43400838,0,-7031897.92544923), dt=30960.7290321349, mu=3531600000000, shortway=false, V1=new Vector3d(1655.92303666715,411.678757537697,268.210860002502), V2=new Vector3d(-55.9927343441051,-92.9655829617332,169.361387329716) },
            new TestSet { R1=new Vector3d(-125135.290152584,939235.915983869,1761250.58622842), R2=new Vector3d(-10306257.1216457,0,-6146630.30794337), dt=30960.7290321349, mu=3531600000000, shortway=true, V1=new Vector3d(-1498.11770644988,714.560504154389,503.244091174869), V2=new Vector3d(154.718367849913,-127.851382388155,-157.631472333776) },
            new TestSet { R1=new Vector3d(-158556.026514215,911973.85636032,1772847.83739451), R2=new Vector3d(-10296905.9261329,0,-6162282.72220361), dt=30960.7290321349, mu=3531600000000, shortway=true, V1=new Vector3d(-1510.16547195516,687.607960808782,504.459134698144), V2=new Vector3d(156.471541493127,-123.163895274321,-158.599747359319) },
            new TestSet { R1=new Vector3d(-1494964.74971371,-1012629.43416853,859995.783250165), R2=new Vector3d(-11400394.7818495,0,-3745797.48758244), dt=24007.4650355032, mu=3531600000000, shortway=true, V1=new Vector3d(-1673.63746035088,-407.745229122275,-5.83168155409791), V2=new Vector3d(12.5411043681711,95.1905465418086,-122.895996719607) },
            new TestSet { R1=new Vector3d(710066.109776306,1446597.36574683,1184498.62918874), R2=new Vector3d(-11531473.33018,0,-3320410.04024313), dt=26132.666250798, mu=3531600000000, shortway=true, V1=new Vector3d(-1187.09321915502,1181.64153529869,458.722274356398), V2=new Vector3d(-11.5299291636242,-221.6793516883,-153.503153803758) },
            new TestSet { R1=new Vector3d(944925.322952843,1515359.25733815,900390.438209926), R2=new Vector3d(-11074108.7417588,0,-4622133.22781827), dt=28959.9772361088, mu=3531600000000, shortway=true, V1=new Vector3d(-974.642720564756,1435.10732531231,72.4003322270351), V2=new Vector3d(30.453576018571,-255.822223540658,-72.7111704187339) },
            new TestSet { R1=new Vector3d(1055216.33138713,1530200.93669642,738186.278412933), R2=new Vector3d(-11467444.2807339,0,-3535211.68648547), dt=26976.5231644278, mu=3531600000000, shortway=false, V1=new Vector3d(883.906434250363,-1490.0225335512,-129.547773427699), V2=new Vector3d(-92.3021264853244,255.056880467594,40.3647892076146) },
            new TestSet { R1=new Vector3d(-110338.88442734,951140.137006945,1755843.02317925), R2=new Vector3d(-11624650.7953621,0,-2977833.75726185), dt=24627.2719086286, mu=3531600000000, shortway=true, V1=new Vector3d(-1486.48342551253,569.199112222084,686.893698729713), V2=new Vector3d(-10.8176064248781,-116.222781890356,-220.776825565245) },
            new TestSet { R1=new Vector3d(504259.898938722,-598340.013779628,-1840621.73541543), R2=new Vector3d(-11950341.0041303,0,-1090573.19103369), dt=25417.3425394552, mu=3531600000000, shortway=true, V1=new Vector3d(-1147.49870071805,-362.206809126897,-1246.80204236586), V2=new Vector3d(-66.2015237430721,72.7377366942549,223.309587053666) },
            new TestSet { R1=new Vector3d(-788472.981603151,-1474361.37774707,-1097581.99943361), R2=new Vector3d(-11378957.504614,0,-3810423.35025778), dt=22441.0387800472, mu=3531600000000, shortway=true, V1=new Vector3d(-1411.38969757414,-582.331945238678,-801.855038034453), V2=new Vector3d(-91.3423689174608,142.52144392408,49.9889201598034) },
            new TestSet { R1=new Vector3d(-857177.995727935,-1494910.04725938,-1015184.59282011), R2=new Vector3d(-10552555.7680567,0,-5713454.88842374), dt=26352.4439489856, mu=3531600000000, shortway=true, V1=new Vector3d(-1307.87427074519,-615.756329298602,-935.113005203095), V2=new Vector3d(6.33891391726744,135.26027656776,53.2944462456717) },
            new TestSet { R1=new Vector3d(968935.439540128,-65666.1686411162,-1748432.1881353), R2=new Vector3d(-10400527.0383478,0,-5985736.15561159), dt=24959.9193197922, mu=3531600000000, shortway=false, V1=new Vector3d(547.677891636452,37.7713086555251,1641.66044414497), V2=new Vector3d(26.6967928565306,-6.97674916663493,-229.646119994098) },
            new TestSet { R1=new Vector3d(1085268.95324121,1531736.8248793,689850.321175209), R2=new Vector3d(-11198343.0221171,0,-4312437.07884546), dt=19079.1121498647, mu=3531600000000, shortway=false, V1=new Vector3d(644.316809664888,-1641.66924265571,-43.3092323532542), V2=new Vector3d(-318.920002693708,247.230901869114,-78.9257946205636) },
            new TestSet { R1=new Vector3d(788116.986564854,1474209.71067719,1097934.38588507), R2=new Vector3d(-10159377.2500761,0,-6386474.29264667), dt=22978.4387981821, mu=3531600000000, shortway=true, V1=new Vector3d(-1077.38707973565,1366.48340763528,-118.801835769983), V2=new Vector3d(-77.3727021604281,-262.343174676466,-155.856930131518) },
            new TestSet { R1=new Vector3d(761598.219179302,1465311.97824113,1128143.97038357), R2=new Vector3d(-7236696.10120871,0,-9572368.02148511), dt=30960.7290321349, mu=3531600000000, shortway=false, V1=new Vector3d(540.407617651269,-1542.60823559911,587.720372789889), V2=new Vector3d(-9.98052691069559,271.769522016031,9.19114586860051) },
            new TestSet { R1=new Vector3d(1480790.74206322,1289977.27305375,-378469.322851105), R2=new Vector3d(-7787938.59615821,0,-9129513.26317396), dt=30960.7290321349, mu=3531600000000, shortway=false, V1=new Vector3d(-3.69933950435413,-904.906420965378,1478.85620555329), V2=new Vector3d(148.826106605629,171.445238072604,-106.545084697449) },
            new TestSet { R1=new Vector3d(1493116.42046002,1241032.93286289,-480075.180162997), R2=new Vector3d(-7823122.46462539,0,-9099382.11657658), dt=30960.7290321349, mu=3531600000000, shortway=true, V1=new Vector3d(55.9045320882586,873.957487497342,-1496.06959249879), V2=new Vector3d(-101.459003610928,-157.934496811895,164.097322926823) },
            new TestSet { R1=new Vector3d(-410905.025780828,688925.268416296,1832037.56973105), R2=new Vector3d(-6699706.99015353,0,-9955597.73424418), dt=30960.7290321349, mu=3531600000000, shortway=true, V1=new Vector3d(-1588.84356820286,694.044941670477,99.8023874534904), V2=new Vector3d(217.87358074445,-120.812436758067,-104.594138370885) },
            new TestSet { R1=new Vector3d(1161176.80326597,1529751.46915795,558086.909893364), R2=new Vector3d(-7463456.18105146,0,-9396638.85831124), dt=30960.7290321349, mu=3531600000000, shortway=true, V1=new Vector3d(-136.104566303769,1409.5992962369,-1004.22375294879), V2=new Vector3d(-46.5121460279616,-247.204528330559,87.5017278576939) },
            new TestSet { R1=new Vector3d(413074.297185933,1306777.53834902,1456555.22064217), R2=new Vector3d(-7070923.14827495,0,-9695465.21994635), dt=30960.7290321349, mu=3531600000000, shortway=false, V1=new Vector3d(916.605136319458,-1451.18180853077,268.300341330302), V2=new Vector3d(-82.2365714437413,254.174012591826,60.3791321798631) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-6682950.07258305,0,-9966853.98344744), dt=30960.7290321349, mu=3531600000000, shortway=false, V1=new Vector3d(1610.75095657108,-645.786622819061,-65.115850993885), V2=new Vector3d(-201.170862461562,114.69394466971,138.189527405109) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-7403560.39135532,0,-9443902.45245866), dt=29319.1011125426, mu=3531600000000, shortway=true, V1=new Vector3d(-1622.27593958365,601.69213267423,141.003561150483), V2=new Vector3d(196.758676491832,-107.209349044357,-142.858360757224) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-7216800.3922934,0,-9587376.70574145), dt=29753.2293685523, mu=3531600000000, shortway=false, V1=new Vector3d(1618.18441414985,-615.022134809576,-131.783888711582), V2=new Vector3d(-204.703004656393,108.78770970914,131.619200242318) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-8739141.50845199,0,-8223588.37097598), dt=25981.1016266962, mu=3531600000000, shortway=true, V1=new Vector3d(-1644.36095780339,512.664608846041,219.002117813152), V2=new Vector3d(127.337960513471,-97.0286797749709,-214.480882792912) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-10051335.8952795,0,-6555199.9756122), dt=22063.3393127814, mu=3531600000000, shortway=false, V1=new Vector3d(1570.1321505505,-491.715419492736,-573.3425725369), V2=new Vector3d(-283.605270479101,80.4560185956911,76.4021652793502) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-8798847.6564052,0,-8159674.00815576), dt=25819.8764527134, mu=3531600000000, shortway=false, V1=new Vector3d(1612.83018622351,-538.114523799704,-353.364951574713), V2=new Vector3d(-229.922993796244,92.7319419644979,105.418807823685) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-7656981.25694084,0,-9239623.26238774), dt=28719.0710428186, mu=3531600000000, shortway=true, V1=new Vector3d(-1627.14287848702,584.327750697449,155.660845794765), V2=new Vector3d(186.359602062493,-105.089961629318,-156.240348367185) },
            new TestSet { R1=new Vector3d(1120606.68199002,1531932.18885859,630356.901523293), R2=new Vector3d(-8955445.01911569,0,-7987490.50137751), dt=27110.7192007318, mu=3531600000000, shortway=false, V1=new Vector3d(408.800982087812,-1522.00110815669,731.350885689704), V2=new Vector3d(-23.9616870228215,260.380136343485,-84.1119469617152) },
            new TestSet { R1=new Vector3d(16927.386605324,1049365.79577693,1702461.67955815), R2=new Vector3d(-10902453.4939867,0,-5013632.19746486), dt=19285.2887546475, mu=3531600000000, shortway=false, V1=new Vector3d(1331.73029494348,-853.178563133935,-765.430914903688), V2=new Vector3d(-353.989776963976,129.504272123142,46.3567211346465) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-11764034.8617695,0,-2368012.62054741), dt=13674.0333304648, mu=3531600000000, shortway=false, V1=new Vector3d(1346.43965674714,-478.76697064467,-1137.06060168356), V2=new Vector3d(-622.07425368643,56.781499391875,41.7796513674705) },
            new TestSet { R1=new Vector3d(1350110.47011008,1469044.67558395,138134.794469532), R2=new Vector3d(-11923716.7173752,0,-1350918.07441759), dt=13908.2347972356, mu=3531600000000, shortway=false, V1=new Vector3d(266.06988748988,-1824.34670252095,48.5595117918603), V2=new Vector3d(-629.016999555465,239.349709774287,-73.6815248726806) },
            new TestSet { R1=new Vector3d(1329171.39118578,1481706.11921861,194465.387267232), R2=new Vector3d(-11439305.7826857,0,-3625228.71143508), dt=18155.111627551, mu=3531600000000, shortway=true, V1=new Vector3d(-982.23411729226,1379.31167168873,-522.371220233068), V2=new Vector3d(-332.735684934005,-287.493312803323,-61.4488875626915) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-11910518.8648148,0,-1462716.7774014), dt=11983.1513754167, mu=3531600000000, shortway=true, V1=new Vector3d(-1795.23145998909,224.677569864162,428.299698023814), V2=new Vector3d(-625.781931569044,-90.2852842671438,-337.555713796286) },
            new TestSet { R1=new Vector3d(1444693.29309909,797259.719120726,-1130192.38171162), R2=new Vector3d(-11840726.1685137,0,1948641.52739135), dt=8911.99659600298, mu=3531600000000, shortway=true, V1=new Vector3d(-1864.0603843089,828.869492883132,-621.05048288493), V2=new Vector3d(-1163.98941769104,-226.641712463294,445.257525123121) },
            new TestSet { R1=new Vector3d(1503285.60649254,1119337.12901741,-698047.175525614), R2=new Vector3d(-11999980.1317643,0,-21836.6037118998), dt=12150.9842806084, mu=3531600000000, shortway=false, V1=new Vector3d(-1366.27705945663,1098.4435138915,-690.188122802692), V2=new Vector3d(-761.204118851311,-265.050352602965,164.554739153804) },
            new TestSet { R1=new Vector3d(506445.548248104,1356143.17340118,1379944.28076915), R2=new Vector3d(-10796720.6904398,0,-5237444.25580157), dt=20241.7725093342, mu=3531600000000, shortway=true, V1=new Vector3d(-1369.64927194648,1070.406467806,230.870104047881), V2=new Vector3d(-137.20545871039,-222.247399866996,-252.444129623689) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-10787064.883639,0,-5257302.65403879), dt=19311.4471085759, mu=3531600000000, shortway=false, V1=new Vector3d(1516.58204996976,-472.49746994978,-742.67734447828), V2=new Vector3d(-351.204811917104,72.5130237523222,56.2435296509754) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-10328757.2950448,0,-6108745.59464213), dt=21094.3531455522, mu=3531600000000, shortway=true, V1=new Vector3d(-1666.67220073443,405.912256517875,316.074441382107), V2=new Vector3d(-31.1947738188188,-88.1254736820771,-301.075581589362) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-8872391.21221515,0,-8079645.67152591), dt=25619.5261815861, mu=3531600000000, shortway=false, V1=new Vector3d(1611.44746072827,-535.025164999064,-364.859241810211), V2=new Vector3d(-231.928060001525,92.0167034984678,103.928318191366) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-10186773.1149025,0,-6342685.03912186), dt=21598.8029901732, mu=3531600000000, shortway=true, V1=new Vector3d(-1664.26615510906,416.102751099617,307.094461976462), V2=new Vector3d(-11.2207605033764,-88.7524036911432,-293.511720598239) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-8716344.14878601,0,-8247747.85501617), dt=26042.3326548493, mu=3531600000000, shortway=false, V1=new Vector3d(1614.24477822778,-541.63098534032,-340.628956793273), V2=new Vector3d(-227.792195536933,93.535823087455,107.060085179971) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-10233181.8644221,0,-6267534.51762834), dt=21435.989131807, mu=3531600000000, shortway=true, V1=new Vector3d(-1665.02955909322,412.798948888038,310.020731012571), V2=new Vector3d(-17.5665316563059,-88.542918073004,-295.994102652781) },
            new TestSet { R1=new Vector3d(1286751.91214323,1501592.61762113,299074.575330467), R2=new Vector3d(-8101595.17569511,0,-8852353.11141358), dt=29632.1908855211, mu=3531600000000, shortway=false, V1=new Vector3d(139.63762182672,-1316.09928927223,1122.75675454697), V2=new Vector3d(74.0409091047509,234.913255704024,-92.2671461657655) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-6682950.07258305,0,-9966853.98344744), dt=30960.7290321349, mu=3531600000000, shortway=false, V1=new Vector3d(1610.75095657108,-645.786622819061,-65.115850993885), V2=new Vector3d(-201.170862461562,114.69394466971,138.189527405109) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-8277845.02624831,0,-8687766.2101035), dt=27187.55399418, mu=3531600000000, shortway=false, V1=new Vector3d(1619.48770322966,-561.217398994122,-275.481158584765), V2=new Vector3d(-218.311584966441,97.8489014335553,115.25009685677) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-9270828.73275908,0,-7619168.89219871), dt=24496.9488820916, mu=3531600000000, shortway=false, V1=new Vector3d(1601.81520114099,-519.039535206645,-429.707399073626), V2=new Vector3d(-244.771841525849,88.1515813224698,95.39472037694) },
            new TestSet { R1=new Vector3d(-446528.573476018,654884.655513795,1836181.06825891), R2=new Vector3d(-9583342.34859875,0,-7222156.84055351), dt=23565.5232577865, mu=3531600000000, shortway=false, V1=new Vector3d(1591.42455778144,-507.423547935985,-484.142051968074), V2=new Vector3d(-257.705658574346,85.1081366627953,88.149798795093) },
        };

        [Test]
        public void TestReferenceTransfers() {
            foreach(var testSet in testSets) {
                Vector3d actualV1;
                Vector3d actualV2;

                LambertBattinSolver.Solve(testSet.R1, testSet.R2, testSet.dt, testSet.mu, testSet.shortway, out actualV1, out actualV2);

                Assert.AreEqual(0.0, (testSet.V1 - actualV1).magnitude, 1e-7);
                Assert.AreEqual(0.0, (testSet.V2 - actualV2).magnitude, 1e-7);
            }
        }
    }

}
